"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1345],{1078:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var i=n(4848),a=n(8453);const r={sidebar_position:7},o="Removing Data",s={id:"tutorials-intermediate/removing-data",title:"Removing Data",description:"Expire data from the database with a time to live (TTL) mechanism.",source:"@site/docs/tutorials-intermediate/removing-data.md",sourceDirName:"tutorials-intermediate",slug:"/tutorials-intermediate/removing-data",permalink:"/docs/docs/tutorials-intermediate/removing-data",draft:!1,unlisted:!1,editUrl:"https://github.com/nodesteram-proj/docs/tree/main/packages/create-docusaurus/templates/shared/docs/tutorials-intermediate/removing-data.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"Working With Migrations",permalink:"/docs/docs/tutorials-intermediate/working-with-migrations"},next:{title:"Tutorials - Advanced",permalink:"/docs/docs/category/tutorials---advanced"}},c={},d=[{value:"Overview",id:"overview",level:2},{value:"Implementing a TTL Pipeline",id:"implementing-a-ttl-pipeline",level:2}];function l(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"removing-data",children:"Removing Data"}),"\n",(0,i.jsx)(t.p,{children:"Expire data from the database with a time to live (TTL) mechanism."}),"\n",(0,i.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(t.p,{children:"The TTL mechanism is a way to expire data from the database after a certain amount of time.\nThis is useful for session data, temporary data, or data that is only relevant for a certain period of time."}),"\n",(0,i.jsxs)(t.p,{children:["In ",(0,i.jsx)(t.code,{children:"nodestream"}),", every node and relationship is annotated with a ",(0,i.jsx)(t.code,{children:"last_ingested_at"})," timestamp.\nUsers can then set the TTL of a node type or relationship type to expire data after a certain amount of time (in hours).\nTo actually expire the data, one must run a pipeline that uses this configuration to remove the data from the database."]}),"\n",(0,i.jsx)(t.h2,{id:"implementing-a-ttl-pipeline",children:"Implementing a TTL Pipeline"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"nodestream"})," comes with a special extractor that can be used to implement the TTL mechanism called ",(0,i.jsx)(t.code,{children:"TimeToLiveConfigurationExtractor"}),".\nThis extractor takes configurations specified and runs the TTL mechanism on the database."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",children:"- implementation: nodestream.pipeline.extractors:TimeToLiveConfigurationExtractor\n  arguments:\n    graph_object_type: NODE\n    configurations:\n      - object_type: Person\n        expiry_in_hours: 96\n      - object_type: Occupation\n        expiry_in_hours: 48\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Remember, that old data will only actually be removed from the database when the pipeline is run.\nTTL pipelines can be run like an other pipeline, for example using the ",(0,i.jsx)(t.code,{children:"nodestream"})," CLI:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"nodestream run ttl-pipeline --target database-to-remove-data-from\n"})}),"\n",(0,i.jsx)(t.p,{children:"The same can be done for relationships:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",children:"- implementation: nodestream.pipeline.extractors:TimeToLiveConfigurationExtractor\n  arguments:\n    graph_object_type: RELATIONSHIP\n    configurations:\n      - object_type: WORKS_AT\n        expiry_in_hours: 24\n      - object_type: FRIEND_OF\n        expiry_in_hours: 48\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Please see the ",(0,i.jsx)(t.a,{href:"../../reference/extractors#timetoliveconfigurationextractor",children:"TimeToLiveConfigurationExtractor"})," for more information."]})]})}function m(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>s});var i=n(6540);const a={},r=i.createContext(a);function o(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);